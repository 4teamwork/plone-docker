CVE-2021-34552: buffer overflow in Convert.c because it allow an attacker to pass
controlled parameters directly into a convert function

--- a/src/libImaging/Convert.c
+++ b/src/libImaging/Convert.c
@@ -1623,9 +1623,8 @@
         return (Imaging) ImagingError_ValueError("conversion not supported");
 #else
     {
-      static char buf[256];
-      /* FIXME: may overflow if mode is too large */
-      sprintf(buf, "conversion from %s to %s not supported", imIn->mode, mode);
+      static char buf[100];
+      snprintf(buf, 100, "conversion from %.10s to %.10s not supported", imIn->mode, mode);
       return (Imaging) ImagingError_ValueError(buf);
     }
 #endif
@@ -1681,9 +1680,13 @@
     }
 #else
     {
-      static char buf[256];
-      /* FIXME: may overflow if mode is too large */
-      sprintf(buf, "conversion from %s to %s not supported in convert_transparent", imIn->mode, mode);
+      static char buf[100];
+      snprintf(
+        buf,
+        100,
+        "conversion from %.10s to %.10s not supported in convert_transparent",
+        imIn->mode,
+        mode);
       return (Imaging) ImagingError_ValueError(buf);
     }
 #endif
